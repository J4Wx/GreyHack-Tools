// LOAD METAXPLOIT
mx = include_lib("/lib/metaxploit.so")
if not mx then
	currentPath = get_shell.host_computer.current_path
	mx = include_lib(currentPath + "/metaxploit.so")
end if

if not mx then 
	exit("Error: Can't find metaxploit.so library in the /lib path or the current folder")
end if;

target = params[0];
port = params[1].to_int;

con = mx.net_use(target, port);

if not con then
	exit("Error: Couldn't connect.");
end if;

smtp = con.dump_lib;

if not smtp then
	exit("Error: Couldn't dump lib.");
end if;

version = smtp.version;

print("SMTP Version: " + version);

sector = "0x7EFF503B";
string = "rivatep";

password = user_input("Enter New Password: ");

res = smtp.overflow(sector, string, password);